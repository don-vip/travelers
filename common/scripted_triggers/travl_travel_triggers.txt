travl_is_teleporting_character_trigger = {
	is_imprisoned = no
	OR = {
		is_pool_character = yes
		is_in_army = yes
		has_variable = gone_adventuring
	}
}

travl_is_travelling_to_receiver_trigger = {
	OR = {
		NOT = { has_variable = travl_travel_receiver }
		var:travl_travel_receiver = $RECEIVER$
	}
	current_travel_plan ?= {
		final_destination_province = $RECEIVER$.capital_province
	}
}

travl_may_travel_to_receiver_trigger = {
	NOR = {
		# Imprisoned by somebody else than the receiver
		AND = {
			is_imprisoned = yes
			NOT = { is_imprisoned_by = $RECEIVER$ }
		}

		# Not imprisoned, landed, and not the receiver
		AND = {
			is_imprisoned = no
			exists = capital_province
			NOT = { this = $RECEIVER$ }
		}

		# Not imprisoned and somebody else's hostage
		AND = {
			is_imprisoned = no
			is_hostage = yes
			NOT = { is_hostage_of = $RECEIVER$ }
		}

		# Not imprisoned and somebody else's guest
		AND = {
			is_imprisoned = no
			is_foreign_court_guest = yes
			NOT = { is_foreign_court_guest_of = $RECEIVER$ }
		}

		# Not imprisoned, hostage, or guest, and somebody else's courtier
		AND = {
			is_imprisoned = no
			is_hostage = no
			is_foreign_court_guest = no
			is_courtier = yes
			NOT = { is_courtier_of = $RECEIVER$ }
		}
	}
}

travl_is_in_travel_entourage_of_trigger = {
	is_travel_entourage_character = yes
	current_travel_plan ?= {
		travel_plan_owner = $OWNER$
	}
}

travl_is_vanilla_travel_owner_trigger = {
	is_travelling = yes
	current_travel_plan ?= {
		travel_plan_owner = prev
	}
	NOT = { has_variable = travl_travel_receiver }
}

travl_is_vanilla_bp2_traveler_trigger = {
	OR = {
		has_variable = hostage_travelling_to_warden
		has_variable = guardian_travelling_to_ward
		has_variable = ward_travelling_to_guardian
		has_variable = adoptee_travelling_to_adopter
	}
}

travl_is_joining_travel_trigger = {
	$OWNER$ = {
		is_travelling = yes
		is_landed = yes
		current_travel_plan ?= {
			days_travelled > 1
		}
	}
	is_travelling = no
	OR = {
		is_at_same_location = $OWNER$
		has_variable = travl_adding_courtier
	}
	OR = {
		AND = {
			is_courtier_of = $OWNER$
			$EVENT$ = flag:on_join_court
		}
		AND = {
			is_imprisoned_by = $OWNER$
			$EVENT$ = flag:on_imprison
		}
	}
}

travl_is_near_saved_location_trigger = {
	save_temporary_scope_as = character
	OR = {
		location = var:travl_location
		AND = {
			is_travelling = yes
			location = {
				any_neighboring_province = {
					this = scope:character.var:travl_location
				}
			}
		}
	}
}

travl_is_near_current_location_trigger = {
	save_temporary_scope_as = character
	current_travel_plan ?= {
		current_location = {
			OR = {
				this = scope:character.location
				any_neighboring_province = {
					this = scope:character.location
				}
			}
		}
	}
}

travl_travel_should_send_message_trigger = {
	OR = {
		this = $CHARACTER$
		liege ?= $CHARACTER$
		host ?= $CHARACTER$
		warden ?= $CHARACTER$
		imprisoner ?= $CHARACTER$
	}
}