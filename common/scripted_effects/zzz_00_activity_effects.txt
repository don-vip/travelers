add_to_court_and_entourage_effect = {
	root = {
		travl_add_courtier_effect = { COURTIER = prev }
	}
	root.current_travel_plan = {
		add_companion = prev
	}
	if = {
		limit = { exists = scope:activity }
		add_to_activity = scope:activity
	}
}

add_to_court_and_entourage_only_effect = {
	root = {
		travl_add_courtier_effect = { COURTIER = prev }
	}
	hidden_effect = {
		root.current_travel_plan = {
			add_companion = prev
		}
	}
}

#The following effects take the CHAR_TO_ADD and NEW_COURT_OWNER scopes, determining if the CHAR_TO_ADD is a pool character since the add_companion automatically adds pool characters as a courtier, whereas if CHAR_TO_ADD is not a pool character, it does not.
# "X joins your Court"
add_to_entourage_court_and_activity_effect = {
	#If the character is a pool character
	$NEW_COURT_OWNER$ = {
		if = {
			limit = {
				#Pool characters get automatically added as courtiers
				$CHAR_TO_ADD$ = { is_pool_character = yes }
			}
			show_as_tooltip = { add_courtier = $CHAR_TO_ADD$ } #This already happens with add_companion
			if = {
				limit = { exists = involved_activity }
				$CHAR_TO_ADD$ = { add_to_activity = $NEW_COURT_OWNER$.involved_activity }
			}
			hidden_effect = {
				if = {
					limit = { $CHAR_TO_ADD$ = { NOT = { exists = current_travel_plan } } }
					current_travel_plan ?= { add_companion = $CHAR_TO_ADD$ }
				}
			}
		}
		#If the character is NOT a pool character
		else = {
			if = {
				limit = {
					$CHAR_TO_ADD$ = {
						NOT = { is_courtier_of = $NEW_COURT_OWNER$ }
					}
				}
				travl_add_courtier_effect = { COURTIER = $CHAR_TO_ADD$ }
			}
			if = {
				limit = { exists = involved_activity }
				$CHAR_TO_ADD$ = { add_to_activity = $NEW_COURT_OWNER$.involved_activity }
			}
			hidden_effect = {
				if = {
					limit = { $CHAR_TO_ADD$ = { NOT = { exists = current_travel_plan } } }
					current_travel_plan ?= { add_companion = $CHAR_TO_ADD$ }
				}
			}
		}
	}
}

# "You recruit X to your Court"
recruit_to_entourage_court_and_activity_effect = {
	#If the character is a pool character
	$NEW_COURT_OWNER$ = {
		if = {
			limit = {
				#Pool characters get automatically added as courtiers
				$CHAR_TO_ADD$ = { is_pool_character = yes }
			}
			show_as_tooltip = { add_courtier = $CHAR_TO_ADD$ } #This already happens with add_companion
			if = {
				limit = { exists = involved_activity }
				$CHAR_TO_ADD$ = { add_to_activity = $NEW_COURT_OWNER$.involved_activity }
			}
			hidden_effect = {
				if = {
					limit = { $CHAR_TO_ADD$ = { NOT = { exists = current_travel_plan } } }
					current_travel_plan ?= { add_companion = $CHAR_TO_ADD$ }
				}
			}
		}
		#If the character is NOT a pool character
		else = {
			if = {
				limit = {
					$CHAR_TO_ADD$ = {
						NOT = { is_courtier_of = $NEW_COURT_OWNER$ }
					}
				}
				travl_add_courtier_effect = { COURTIER = $CHAR_TO_ADD$ }
			}
			if = {
				limit = { exists = involved_activity }
				$CHAR_TO_ADD$ = { add_to_activity = $NEW_COURT_OWNER$.involved_activity }
			}
			hidden_effect = {
				if = {
					limit = { $CHAR_TO_ADD$ = { NOT = { exists = current_travel_plan } } }
					current_travel_plan ?= { add_companion = $CHAR_TO_ADD$ }
				}
			}
		}
	}
}